<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ch√° Cozinha Mayssa</title>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        /* --- TEMA MARROM TERRA / CHOCOLATE --- */
        :root { --cor-principal: #6d4c41; --cor-fundo: #faf7f2; --cor-texto: #4a4a4a; --cor-destaque: #a1887f; --cor-botao-verde: #5cb85c; --cor-borda: #d7ccc8; }
        body { font-family: 'Roboto', sans-serif; background-color: var(--cor-fundo); color: var(--cor-texto); margin: 0; padding: 0; line-height: 1.6; }
        
        /* CABE√áALHO */
        header { 
            background-color: var(--cor-principal); 
            color: white; 
            text-align: center; 
            padding: 80px 20px; 
            background-image: 
                linear-gradient(to bottom, rgba(109, 76, 65, 0.85), rgba(109, 76, 65, 0.7)), 
                url('biblia.jpeg'), url('biblia.jpg'), url('biblia.png'), url('biblia.webp'); 
            background-size: cover; 
            background-position: center; 
            position: relative; 
            z-index: 1; 
        }

        @media print { header, .btn-voltar, .submit-btn, .nav-btn, h2, .versiculo-final, .warning-box, .welcome-text { display: none !important; } body { background: white; } .container { box-shadow: none; border: none; margin: 0; padding: 0; min-height: auto; } #thank-you-card { border: 2px solid #000; break-inside: avoid; } }

        h1 { font-family: 'Playfair Display', serif; font-size: 3.5em; margin: 0; font-weight: 700; letter-spacing: 1px; text-shadow: 2px 2px 15px rgba(0,0,0,0.9); line-height: 1.1; }
        .welcome-text { font-size: 1.25em; max-width: 800px; margin: 20px auto; font-weight: 400; text-shadow: 1px 1px 8px rgba(0,0,0,0.9); line-height: 1.6; }
        
        /* DATA E LOCAL */
        .event-info {
            margin: 25px auto; 
            padding: 20px; 
            border-top: 1px solid rgba(255,255,255,0.4); 
            border-bottom: 1px solid rgba(255,255,255,0.4); 
            max-width: 700px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        .event-info p { margin: 8px 0; font-size: 1.2em; text-shadow: 1px 1px 5px rgba(0,0,0,0.8); }

        /* CONTAGEM REGRESSIVA */
        .countdown-box {
            background: rgba(255, 255, 255, 0.25);
            padding: 10px 25px;
            border-radius: 50px;
            display: inline-block;
            margin-top: 15px;
            font-weight: bold;
            font-family: 'Comfortaa';
            font-size: 1.1em;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.6);
            border: 1px solid rgba(255,255,255,0.4);
        }

        .versiculo { font-family: 'Playfair Display', serif; font-style: italic; font-size: 1.1em; background: rgba(255,255,255,0.15); padding: 20px; border-radius: 15px; margin-top: 30px; display: inline-block; border: 1px solid rgba(255,255,255,0.3); text-shadow: 1px 1px 5px rgba(0,0,0,0.8); max-width: 90%; }
        
        .couple-photo-container { margin-top: 30px; text-align: center; position: relative; z-index: 2; }
        .couple-photo { max-width: 250px; width: 70%; height: auto; border-radius: 50% 50% 20px 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.6); border: 5px solid rgba(255,255,255,0.9); object-fit: cover; background-color: #ddd; }
        
        .container { max-width: 800px; margin: -50px auto 40px; background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); position: relative; z-index: 10; min-height: 400px; }
        
        h2 { font-family: 'Comfortaa', cursive; color: var(--cor-principal); font-weight: 700; }
        .categoria-titulo { font-family: 'Playfair Display', serif; color: var(--cor-principal); font-size: 1.6em; margin-top: 40px; margin-bottom: 15px; border-bottom: 2px solid #eee; padding-bottom: 5px; }
        
        input[type="text"] { font-family: 'Roboto', sans-serif; width: 100%; padding: 15px; border: 2px solid #eee; border-radius: 12px; font-size: 16px; box-sizing: border-box; margin-bottom: 20px; -webkit-appearance: none; }
        input[type="text"]:focus { outline: none; border-color: var(--cor-principal); }
        
        .nav-btn { font-family: 'Comfortaa', cursive; display: block; width: 100%; padding: 20px; margin: 15px 0; background: white; border: 2px solid var(--cor-principal); color: var(--cor-principal); font-size: 1.1em; border-radius: 50px; cursor: pointer; transition: 0.3s; font-weight: bold; -webkit-tap-highlight-color: transparent; }
        .nav-btn:hover { background: var(--cor-principal); color: white; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        .btn-voltar { background: transparent; border: 2px solid var(--cor-principal); color: var(--cor-principal); padding: 8px 25px; border-radius: 20px; cursor: pointer; font-family: 'Comfortaa'; font-size: 0.95em; display: inline-flex; align-items: center; margin-bottom: 25px; transition: 0.3s; font-weight: bold; position: relative; z-index: 20; }
        
        .gift-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 12px; }
        .gift-item { font-family: 'Roboto', sans-serif; padding: 15px; border: 1px solid #e0e0e0; border-radius: 12px; text-align: center; cursor: pointer; transition: 0.2s; background-color: white; font-size: 0.95em; }
        .gift-item:hover { background-color: #fcece6; border-color: var(--cor-principal); }
        .gift-item.selected { background-color: var(--cor-principal); color: white; transform: scale(1.02); border-color: var(--cor-principal); font-weight: bold; box-shadow: 0 5px 15px rgba(109, 76, 65, 0.3); }
        .gift-item.taken { background-color: #f0f0f0; color: #aaa; pointer-events: none; border-color: #eee; text-decoration: line-through; opacity: 0.7; }
        
        .submit-btn { font-family: 'Comfortaa', cursive; background-color: #27ae60; color: white; border: none; padding: 18px 40px; font-size: 1.2em; border-radius: 50px; cursor: pointer; margin-top: 30px; width: 100%; font-weight: bold; transition: 0.3s; }
        
        .hidden { display: none; }
        .warning-box { background: #fff8e1; color: #795548; border-left: 5px solid #ffc107; padding: 15px; border-radius: 10px; font-size: 0.95em; margin-bottom: 20px; }
        .pix-box { background: #fbf5f3; padding: 20px; border-radius: 15px; border: 2px dashed var(--cor-principal); margin: 30px 0; text-align: center; word-break: break-all; }
        
        .reminder-card { background-color: #fffaf0; border: 2px dashed var(--cor-principal); padding: 20px; border-radius: 15px; margin: 20px auto; max-width: 500px; position: relative; }
        .reminder-title { font-family: 'Playfair Display', serif; color: var(--cor-principal); font-size: 1.4em; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 2px; }
        .reminder-info { font-size: 1.1em; margin: 10px 0; color: #555; }
        .reminder-value { font-weight: bold; color: var(--cor-principal); font-size: 1.2em; }
        .reminder-footer { margin-top: 20px; font-size: 0.8em; color: #999; border-top: 1px solid #ddd; padding-top: 10px; }

        /* --- NOVO ESTILO DO AGRADECIMENTO --- */
        .thank-you-header {
            animation: fadeIn 1s ease-in;
        }
        .thank-you-icon {
            font-size: 4em;
            display: block;
            margin-bottom: 10px;
            animation: bounce 2s infinite;
        }
        .thank-you-title {
            font-family: 'Playfair Display', serif;
            color: #27ae60;
            font-size: 2.5em;
            margin: 0;
            line-height: 1.2;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 600px) {
            header { padding: 60px 15px 100px; }
            h1 { font-size: 2.2em; }
            .welcome-text { font-size: 1em; padding: 0 10px; }
            .couple-photo { width: 65%; margin-top: 0; } 
            .container { margin: -40px 10px 20px; padding: 25px 20px; }
            .gift-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
            .nav-btn { font-size: 1em; padding: 15px; }
            .submit-btn { width: 100%; padding: 15px; font-size: 1.1em; }
            .event-info p { font-size: 1em; }
            .thank-you-title { font-size: 2em; }
        }
    </style>
</head>
<body>

<header>
    <h1>Ch√° de Casa Nova da Mayssa</h1>
    <div class="welcome-text">
        Sejam muito bem-vindos ao come√ßo do nosso sonho! <br><br>
        Estamos preparando cada detalhe do nosso novo lar com muito amor. <br>
        <strong>Obrigado por fazerem parte da nossa hist√≥ria!</strong>
    </div>

    <div class="event-info">
        <p> <strong>Data:</strong> 25 de Janeiro de 2026 √†s 13:00h</p>
        <p> <strong>Local:</strong> Rua Imirim, 75 - F√°tima, Jandira</p>
    </div>

    <div class="countdown-box">
        ‚è≥ Faltam <span id="contador">0</span> dias para o Ch√°!
    </div>

    <div class="couple-photo-container">
        <img src="casal.jpg" onerror="this.src='casal.jpeg'" alt="Foto do Casal Mayssa" class="couple-photo">
    </div>
    <div class="versiculo">
        "Se dois de v√≥s concordarem na terra acerca de qualquer coisa que pedirem, isso lhes ser√° feito por meu Pai..." <br>
        <small style="font-family: 'Roboto', sans-serif; font-style: normal; margin-top:5px; display:block;">- Mateus 18:19</small>
    </div>
</header>

<div class="container">
    <div id="section-1">
        <h2>Como voc√™s gostariam de nos aben√ßoar?</h2>
        <p>Antes de escolher, por favor, digite seu nome:</p>
        <input type="text" id="guestName" placeholder="Seu Nome..." required>
        <p style="margin-top: 30px;">Selecione uma op√ß√£o abaixo:</p>
        <button class="nav-btn" onclick="goToSection(2)">üéÅ Escolher um Presente da Lista</button>
        <button class="nav-btn" onclick="goToSection(3)">‚ú® Enviar um Pix ou Presente Surpresa</button>
    </div>

    <div id="section-2" class="hidden">
        <button class="btn-voltar" onclick="goToSection(1)">‚¨Ö Voltar ao in√≠cio</button>
        <h2>Escolha do Item</h2>
        <p><strong>Descri√ß√£o:</strong> Toque no item que deseja dar de presente.</p>
        <div class="warning-box">‚ö†Ô∏è Selecione um item e clique em Enviar. O item sair√° da lista automaticamente.</div>
        <div id="giftListContainer">Carregando lista de presentes...</div>
        <button class="submit-btn" onclick="finalizarEnvio('Lista')">Enviar Escolha</button>
    </div>

    <div id="section-3" class="hidden">
        <button class="btn-voltar" onclick="goToSection(1)">‚¨Ö Voltar ao in√≠cio</button>
        <h2>Outras Formas de nos Aben√ßoar ‚ù§Ô∏è</h2>
        <p>Se voc√™ preferir a praticidade, criamos este espa√ßo especial.</p>
        <div class="pix-box">
            <h3 style="margin-top:0;">Chave Pix Aben√ßoada:</h3>
            <p style="font-size: 1.5em; font-weight: bold; color: var(--cor-principal); font-family: 'Roboto', sans-serif; margin: 10px 0;">1198739-3992</p>
            <p style="font-weight: bold; margin: 5px 0;">Mayssa Martha Francisco da Silva</p>
            <p style="color: #666;"><small>(Confirme os dados antes de enviar)</small></p>
        </div>
        <p>Qual item voc√™ escolhe para aben√ßoar o nosso novo lar? (Opcional):</p>
        <input type="text" id="customGift" placeholder="Ex: Vou levar um presente surpresa...">
        <button class="submit-btn" onclick="finalizarEnvio('Pix/Outro')">Confirmar</button>
    </div>

    <div id="thank-you-screen" class="hidden" style="text-align: center; padding: 10px;">
        
        <div class="thank-you-header">
            <span class="thank-you-icon">üôå</span>
            <h2 class="thank-you-title">Gl√≥ria a Deus!</h2>
        </div>

        <div style="margin: 20px auto; padding: 15px; background: #fff; border-radius: 15px; max-width: 600px;">
            <p style="font-size: 1.05em; line-height: 1.6; color: #555;">
                N√£o tenho palavras para agradecer... ‚ù§Ô∏è <br>
                Ver o seu carinho com a gente nos faz sentir o quanto somos amados. Que Deus multiplique infinitamente na sua vida! <br>
                Obrigada por tanto!
            </p>
        </div>
        <div id="thank-you-card" class="reminder-card">
            <div class="reminder-title">Lembrete do Presente</div>
            <div style="border-bottom: 1px solid #eee; margin-bottom: 15px;"></div>
            <p class="reminder-info">Convidado(a):</p>
            <p class="reminder-value" id="card-name">Nome</p>
            <p class="reminder-info" style="margin-top:15px;">Item Escolhido:</p>
            <p class="reminder-value" id="card-item" style="color: #27ae60;">Item</p>
            <div class="reminder-footer">Ch√° da Mayssa ‚Ä¢ Deus Aben√ßoe!</div>
        </div>
        <p style="color: #999; font-size: 0.9em; margin-top: 10px;">üì∏ <em>Tire um print para guardar!</em></p>
        <br>
        <div class="versiculo-final" style="color: #555; background: #eee; border-radius: 10px; padding: 10px; display: inline-block;">"Deus te aben√ßoe grandemente!"</div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getFirestore, collection, addDoc, onSnapshot, query, where } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyB3JVacaEdp0xjHjd8faxmqPu3vJX9TS8M",
      authDomain: "cha-cozinha-mayssa.firebaseapp.com",
      projectId: "cha-cozinha-mayssa",
      storageBucket: "cha-cozinha-mayssa.firebasestorage.app",
      messagingSenderId: "574353624372",
      appId: "1:574353624372:web:6bfaf5851fb07b0811e961",
      measurementId: "G-95HZS9ZX4L"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // --- L√ìGICA DA CONTAGEM REGRESSIVA ---
    function iniciarContagem() {
        const dataCha = new Date(2026, 0, 25); // Ano 2026, M√™s 0 (Janeiro), Dia 25
        const hoje = new Date();
        const diferenca = dataCha - hoje;
        const dias = Math.ceil(diferenca / (1000 * 60 * 60 * 24));
        const elemento = document.getElementById("contador");
        if(elemento) {
            elemento.innerText = dias > 0 ? dias : 0;
        }
    }
    iniciarContagem(); 

    const categorias = {
        "Eletrodom√©sticos": ["Liquidificador", "Ferro de Passar", "Sanduicheira", "Ventilador", "Cafeteira"],
        "Utens√≠lios de Cozinha": ["Jogo de Panelas", "Panela de Press√£o", "Frigideira", "Cuscuzeira", "Faqueiro (Dia a dia)", "Kit de Conchas (Silicone)", "Jogo de X√≠caras", "Jogo de Copos", "Garrafa T√©rmica", "Assadeira (Tabuleiro)", "Forma de Bolo", "Forma de P√£o", "T√°bua de Corte", "Ralador", "Potes Pl√°sticos", "Fruteira", "Escorredor de Lou√ßa", "Abridor de Latas", "Espremedor de Alho", "Espremedor de Lim√£o", "Peneira", "Fouet (Batedor)", "Descascador de Legumes", "Concha de Sorvete", "Forminhas de Gelo", "Saladeira", "A√ßucareiro e Saleiro"],
        "Cama, Mesa e Banho": ["Jogo de Cama", "Coberta", "Edredom", "Jogo de Toalhas", "Kit Pia Banheiro", "Tapete Antiderrapante (Box)"],
        "Limpeza e Organiza√ß√£o": ["Kit Panos de Prato", "Panos de Ch√£o", "Lixeira de Pia", "Lixeira de Banheiro", "Vassoura e P√°", "Rodo e Balde", "Cesto de Roupa", "Pregadores", "Tapete de Entrada", "Cabides"]
    };

    let itemSelecionado = null;
    let itensJaComprados = [];

    const q = query(collection(db, "presentes_escolhidos"));
    onSnapshot(q, (snapshot) => {
        itensJaComprados = [];
        snapshot.forEach((doc) => {
            itensJaComprados.push(doc.data().item);
        });
        renderizarLista(); 
    });

    function renderizarLista() {
        const containerLista = document.getElementById('giftListContainer');
        containerLista.innerHTML = "";

        for (const [nomeCategoria, itens] of Object.entries(categorias)) {
            const titulo = document.createElement('h3');
            titulo.className = 'categoria-titulo';
            titulo.innerText = nomeCategoria;
            containerLista.appendChild(titulo);

            const grid = document.createElement('div');
            grid.className = 'gift-grid';

            itens.forEach(item => {
                const div = document.createElement('div');
                div.className = 'gift-item';
                div.innerText = item;

                if (itensJaComprados.includes(item)) {
                    div.classList.add('taken');
                    div.title = "J√° escolhido por outro convidado";
                } else {
                    div.onclick = () => selecionar(div, item);
                }
                
                if (item === itemSelecionado) {
                    div.classList.add('selected');
                }

                grid.appendChild(div);
            });
            containerLista.appendChild(grid);
        }
    }

    window.selecionar = function(elemento, nome) {
        document.querySelectorAll('.gift-item').forEach(e => e.classList.remove('selected'));
        elemento.classList.add('selected');
        itemSelecionado = nome;
    }

    window.goToSection = function(num) {
        const nome = document.getElementById('guestName').value;
        if (num > 1 && nome.trim() === "") {
            alert("Por favor, digite seu nome primeiro! ‚ù§Ô∏è");
            return;
        }
        document.getElementById('section-1').classList.add('hidden');
        document.getElementById('section-2').classList.add('hidden');
        document.getElementById('section-3').classList.add('hidden');
        document.getElementById('section-' + num).classList.remove('hidden');
        window.scrollTo(0, 0);
    }

    window.finalizarEnvio = async function(tipo) {
        const nomeConvidado = document.getElementById('guestName').value;
        let presenteFinal = itemSelecionado;

        if (tipo === 'Lista') {
            if (!itemSelecionado) {
                alert("Por favor, selecione um item para aben√ßoar o lar! üôè");
                return;
            }
            try {
                await addDoc(collection(db, "presentes_escolhidos"), {
                    item: itemSelecionado,
                    quem: nomeConvidado,
                    data: new Date()
                });
            } catch (e) {
                console.error("Erro ao salvar: ", e);
                alert("Houve um erro ao salvar. Tente novamente.");
                return;
            }
        } 
        else if (tipo === 'Pix/Outro') {
            const textoPersonalizado = document.getElementById('customGift').value;
            presenteFinal = textoPersonalizado.trim() !== "" ? textoPersonalizado : "Contribui√ß√£o via Pix / Surpresa";
            try {
                await addDoc(collection(db, "pix_confirmados"), {
                    descricao: presenteFinal,
                    quem: nomeConvidado,
                    data: new Date()
                });
            } catch (e) {}
        }

        document.getElementById('card-name').innerText = nomeConvidado;
        document.getElementById('card-item').innerText = presenteFinal;

        document.getElementById('section-2').classList.add('hidden');
        document.getElementById('section-3').classList.add('hidden');
        document.getElementById('thank-you-screen').classList.remove('hidden');
        
        window.scrollTo(0, 0);
    }
</script>

</body>
</html>